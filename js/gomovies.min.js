function check_login() {
    $.ajax({
        url: base_url + "ajax/load_login_status",
        type: "GET",
        dataType: "json",
        success: function(e) {
            $("#top-user").html(e.content), 1 == e.is_login && (is_login = !0)
        }
    })
}

function favorite(e, s, t) {
    is_login ? ("undefined" == typeof t && (t = "add"), $(".btn-favorite-" + e).prop("disabled", !0), $(".bp-btn-like").prop("disabled", !0), $.ajax({
        url: base_url + "ajax/user_favorite",
        method: "POST",
        data: {
            movie_id: e,
            action: t
        },
        dataType: "json",
        success: function(t) {
            $(".btn-favorite-" + e).removeAttr("disabled"), $(".bp-btn-like").removeAttr("disabled"), 1 == t.status && (1 == s ? ($("#message-content").html(t.message), $("#pop-alert").modal("show"), "user" == window.location.pathname.split("/")[1] && $("[data-movie-id=" + e + "]").addClass("ml-item-remove")) : ($("#favorite-alert").show(), $("#favorite-message").html(t.message), setTimeout(function() {
                $("#favorite-alert").hide()
            }, 5e3), $("#button-favorite").html(t.content), $(".popover-like").hide()))
        }
    })) : $("#pop-login").modal("show")
}

function goRequestPage(e) {
    is_login ? window.location.href = e : $("#pop-login").modal("show")
}

function clearNotify() {
    var e = confirm("Are you sure delete all notify?");
    e && $.ajax({
        url: base_url + "ajax/user_clear_notify",
        method: "POST",
        dataType: "json",
        success: function(e) {
            1 == e.status && window.location.reload()
        }
    })
}

function loadNotify() {
    0 == $("#list-notify .notify-item").length && $.ajax({
        url: base_url + "ajax/user_load_notify",
        type: "GET",
        dataType: "json",
        success: function(e) {
            1 == e.status && ($("#notify-loading").remove(), $("#list-notify").html(e.html), e.notify_unread > 0 ? $(".feed-number").text(e.notify_unread) : $(".feed-number").text(""))
        }
    })
}

function ajaxContentBox(e) {
    $("div#" + e + " #content-box").is(":empty") && $.ajax({
        url: base_url + "ajax/get_content_box/" + e,
        type: "GET",
        dataType: "json",
        success: function(e) {
            switch (e.type) {
                case "topview-today":
                    $("#topview-today #content-box").html(e.content);
                    break;
                case "top-favorite":
                    $("#top-favorite #content-box").html(e.content);
                    break;
                case "top-rating":
                    $("#top-rating #content-box").html(e.content);
                    break;
                case "top-imdb":
                    $("#top-imdb #content-box").html(e.content)
            }
        }
    })
}

function updateMovieView(e) {
    $.cookie("view-" + e) || $.ajax({
        url: base_url + "ajax/movie_update_view",
        type: "POST",
        dataType: "json",
        data: {
            id: e
        },
        success: function() {
            var s = new Date,
                t = 2;
            s.setTime(s.getTime() + 60 * t * 1e3), $.cookie("view-" + e, !0, {
                expires: s,
                path: "/"
            })
        }
    })
}

function validateEmail(e) {
    var s = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
    return e.length > 0 && s.test(e)
}

function subscribe() {
    if (!$.cookie("subscribed")) {
        $("#error-email-subs").hide();
        var e = $("input[name=email]").val();
        "" == e.trim() ? ($("#error-email-subs").text("Please enter your email."), $("#error-email-subs").show()) : validateEmail(e) ? ($("#subscribe-submit").prop("disabled", !0), $("#subscribe-loading").show(), $.ajax({
            url: base_url + "site/subscribe",
            type: "POST",
            dataType: "json",
            data: {
                email: e
            },
            success: function(e) {
                1 == e.status && ($("#pop-subc").modal("hide"), $.cookie("subscribed", 1, {
                    expires: 365,
                    path: "/"
                }), $.cookie("subscribe", 1, {
                    expires: 365,
                    path: "/"
                })), $("#subscribe-loading").hide(), $("#subscribe-submit").removeAttr("disabled")
            }
        })) : ($("#error-email-subs").text("Please enter a valid email."), $("#error-email-subs").show())
    }
}

function subscribe_home() {
    if (!$.cookie("subscribed")) {
        $("#error-email-subs").hide(), $("#success-subs").hide();
        var e = $("input[name=email-home]").val();
        "" == e.trim() ? ($("#error-email-subs").text("Please enter your email."), $("#error-email-subs").show()) : validateEmail(e) ? ($("#subscribe-submit-home").prop("disabled", !0), $.ajax({
            url: base_url + "site/subscribe",
            type: "POST",
            dataType: "json",
            data: {
                email: e
            },
            success: function(e) {
                1 == e.status ? ($("#success-subs").text("Thank you for subscribing!"), $("#success-subs").show(), $.cookie("subscribed", 1, {
                    expires: 365,
                    path: "/"
                }), $.cookie("subscribe", 1, {
                    expires: 365,
                    path: "/"
                })) : ($("#error-email-subs").text("Subscribe failed."), $("#error-email-subs").show()), $("#subscribe-submit-home").removeAttr("disabled")
            }
        })) : ($("#error-email-subs").text("Please enter a valid email."), $("#error-email-subs").show())
    }
}

function subscribe_footer() {
    if (!$.cookie("subscribed")) {
        $("#error-email-subs-footer").hide(), $("#success-subs-footer").hide();
        var e = $("input[name=email-footer]").val();
        "" == e.trim() ? ($("#error-email-subs-footer").text("Please enter your email."), $("#error-email-subs-footer").show()) : validateEmail(e) ? ($("#subscribe-submit-footer").prop("disabled", !0), $.ajax({
            url: base_url + "site/subscribe",
            type: "POST",
            dataType: "json",
            data: {
                email: e
            },
            success: function(e) {
                1 == e.status ? ($("#success-subs-footer").text("Thank you for subscribing!"), $("#success-subs-footer").show(), $.cookie("subscribed", 1, {
                    expires: 365,
                    path: "/"
                }), $.cookie("subscribe", 1, {
                    expires: 365,
                    path: "/"
                })) : ($("#error-email-subs-footer").text("Subscribe failed."), $("#error-email-subs-footer").show()), $("#subscribe-submit-footer").removeAttr("disabled")
            }
        })) : ($("#error-email-subs-footer").text("Please enter a valid email."), $("#error-email-subs-footer").show())
    }
}

function isCookieEnabled() {
    var e = !!navigator.cookieEnabled;
    return "undefined" != typeof navigator.cookieEnabled || e || (document.cookie = "testcookie", e = -1 != document.cookie.indexOf("testcookie")), e
}

function searchMovie() {
    var e = $("input[name=keyword]").val();
    "" !== e.trim() && (e = e.replace(/(<([^>]+)>)/gi, "").replace(/[`~!@#$%^&*()_|\=?;:'",.<>\{\}\[\]\\\/]/gi, ""), e = e.split(" ").join(" "), window.location.href = base_url + "movie/search/" + e)
}

function searchMovieHome() {
    var e = $("input[name=keyword-home]").val();
    "" !== e.trim() && (e = e.replace(/(<([^>]+)>)/gi, "").replace(/[`~!@#$%^&*()_|\=?;:'",.<>\{\}\[\]\\\/]/gi, ""), e = e.split(" ").join(" "), window.location.href = base_url + "movie/search/" + e)
}
var base_url = "//" + document.domain + "/";
$.cookie("_g_geo_2") || $.getJSON("//" + document.domain + "/site/user_geo", function(e) {
    var s = ["US", "GB", "CA", "DE", "ES", "SG", "FI", "FR", "SE", "NO", "CH", "DK"];
    s.indexOf(e.country) >= 0 ? $.cookie("_g_geo_3", 1, {
        expires: 1
    }) : $.cookie("_g_geo_3", 0, {
        expires: 1
    }), console.log(e)
});
var is_login = !1;
$(document).ready(function() {
    function e() {
        $(this).find(".sub-container").css("display", "block")
    }

    function s() {
        $(this).find(".sub-container").css("display", "none")
    }
    if (zy = $("body").attr("data-ts"), check_login(), $("#search a.box-title").click(function() {
            $("#search .box").toggleClass("active")
        }), $(".mobile-menu").click(function() {
            $("#menu,.mobile-menu").toggleClass("active"), $("#search, .mobile-search").removeClass("active")
        }), $(".mobile-search").click(function() {
            $("#search,.mobile-search").toggleClass("active"), $("#menu, .mobile-menu").removeClass("active")
        }), $(".filter-toggle").click(function() {
            $("#filter").toggleClass("active"), $(".filter-toggle").toggleClass("active")
        }), $(".bp-btn-light").click(function() {
            $(".bp-btn-light, #overlay, #media-player, #content-embed, #comment-area").toggleClass("active")
        }), $("#overlay").click(function() {
            $(".bp-btn-light, #overlay, #media-player, #content-embed, #comment-area").removeClass("active")
        }), $(".bp-btn-auto").click(function() {
            $(".bp-btn-auto").toggleClass("active")
        }), $("#toggle, .cac-close").click(function() {
            $("#comment").toggleClass("active")
        }), $(".top-menu> li").bind("mouseover", e), $(".top-menu> li").bind("mouseout", s), $("#slider").length > 0) {
        new Swiper("#slider", {
            pagination: ".swiper-pagination",
            paginationClickable: !0,
            loop: !0,
            autoplay: 4e3
        });
        $(function() {
            $(".tn-news, .tn-notice").perfectScrollbar()
        })
    }
    $("#switch-mode").click(function() {
        $.cookie("night-mode") ? $.removeCookie("night-mode", {
            path: "/"
        }) : $.cookie("night-mode", 1, {
            expires: 365,
            path: "/"
        }), location.reload()
    }), $.cookie("night-mode") && $("#switch-mode").addClass("active");
    var t = 0;
    $(window).on("scroll", function() {
        $(window).scrollTop() < t ? "fixed" != $("header").css("position") && ($("header").css({
            position: "fixed",
            top: -$("header").outerHeight()
        }), $("header").animate({
            top: "0px"
        }, 500), $("#main").css("padding-top", $("header").outerHeight())) : ($("header").css({
            position: "relative",
            top: "0px"
        }), $("#main").css("padding-top", "0px")), t = $(window).scrollTop()
    }), $(function() {
        function e() {
            var e = $(this),
                s = e.find(".modal-dialog");
            e.css("display", "block"), s.css("margin-top", Math.max(0, ($(window).height() - s.height()) / 2))
        }
        $(".modal").on("show.bs.modal", e), $(window).on("resize", function() {
            $(".modal:visible").each(e)
        })
    });
    var o = !0;
    $("#search-suggest-menu").mouseover(function() {
        o = !1
    }), $("#search-suggest-menu").mouseout(function() {
        o = !0
    });
    var a = null;
    $("input[name=keyword]").keyup(function() {
        null != a && clearTimeout(a), a = setTimeout(function() {
            a = null;
            var e = $("input[name=keyword]").val().trim();
            e.length > 2 ? $.ajax({
                url: base_url + "ajax/suggest_search",
                type: "POST",
                dataType: "json",
                data: {
                    keyword: e
                },
                success: function(e) {
                    $("#search-suggest-menu").html(e.content), "" !== e.content.trim() ? $("#search-suggest-menu").show() : $("#search-suggest-menu").hide()
                }
            }) : $("#search-suggest-menu").hide()
        }, 600)
    }), $("input[name=keyword]").blur(function() {
        o && $("#search-suggest-menu").hide()
    }), $("input[name=keyword]").focus(function() {
        "" !== $("#search-suggest-menu").html() && $("#search-suggest-menu").show()
    }), $("input[name=keyword]").keypress(function(e) {
        13 == e.which && searchMovie()
    });
    var i = !0;
    $("#search-suggest-home").mouseover(function() {
        i = !1
    }), $("#search-suggest-home").mouseout(function() {
        i = !0
    }), $("input[name=keyword-home]").keyup(function() {
        null != a && clearTimeout(a), a = setTimeout(function() {
            a = null;
            var e = $("input[name=keyword-home]").val().trim();
            e.length > 2 ? $.ajax({
                url: base_url + "ajax/suggest_search",
                type: "POST",
                dataType: "json",
                data: {
                    keyword: e
                },
                success: function(e) {
                    $("#search-suggest-home").html(e.content), "" !== e.content.trim() ? $("#search-suggest-home").show() : $("#search-suggest-home").hide()
                }
            }) : $("#search-suggest-home").hide()
        }, 600)
    }), $("input[name=keyword-home]").blur(function() {
        i && $("#search-suggest-home").hide()
    }), $("input[name=keyword-home]").focus(function() {
        "" !== $("#search-suggest-home").html() && $("#search-suggest-home").show()
    }), $("input[name=keyword-home]").keypress(function(e) {
        13 == e.which && searchMovieHome()
    }), $("#login-form").submit(function(e) {
        $("#login-submit").prop("disabled", !0), $("#login-loading").show();
        var s = $(this).serializeArray(),
            t = $(this).attr("action");
        $.ajax({
            url: t,
            type: "POST",
            data: s,
            dataType: "json",
            success: function(e) {
                e.status ? (is_login = !0, $("#top-user").html(e.html), $("#pop-login").modal("hide")) : ($("#error-message").show(), $("#error-message").text(e.message), $("#login-submit").removeAttr("disabled"), $("#login-loading").hide())
            }
        }), e.preventDefault()
    }), $("#register-form").submit(function(e) {
        $("#register-submit").prop("disabled", !0), $("#register-loading").show();
        var s = $(this).serializeArray(),
            t = $(this).attr("action");
        $.ajax({
            url: t,
            type: "POST",
            data: s,
            dataType: "json",
            success: function(e) {
                if ($(".error-block").hide(), e.status) is_login = !0, $("#top-user").html(e.html), $("#pop-register").modal("hide");
                else {
                    for (var s in e.messages) $("#error-" + s).show(), $("#error-" + s).text(e.messages[s]);
                    $("#register-submit").removeAttr("disabled"), $("#register-loading").hide(), grecaptcha.reset(recap_register)
                }
            }
        }), e.preventDefault()
    }), $("#forgot-form").submit(function(e) {
        $("#forgot-submit").prop("disabled", !0), $("#forgot-loading").show();
        var s = $(this).serializeArray();
        $.ajax({
            url: base_url + "user/forgotPassword",
            type: "POST",
            data: s,
            dataType: "json",
            success: function(e) {
                0 == e.status && ($("#forgot-error-message").show(), $("#forgot-error-message").text(e.message)), 1 == e.status && ($("#forgot-success-message").show(), $("#forgot-success-message").text(e.message)), $("#forgot-submit").removeAttr("disabled"), $("#forgot-loading").hide()
            }
        }), e.preventDefault()
    }), $("#request-form").submit(function(e) {
        $("#request-submit").prop("disabled", !0), $("#request-loading").show();
        var s = $(this).serializeArray();
        $.ajax({
            url: "/ajax/user_request",
            type: "POST",
            data: s,
            dataType: "json",
            success: function(e) {
                if ($(".error-block").hide(), 0 == e.status)
                    for (var s in e.messages) $("#error-" + s).show(), $("#error-" + s).text(e.messages[s]);
                1 == e.status && ($("#message-success").show(), setTimeout(function() {
                    $("#message-success").hide()
                }, 5e3), document.getElementById("request-form").reset()), $("#request-submit").removeAttr("disabled"), $("#request-loading").hide(), grecaptcha.reset(recap_request)
            }
        }), e.preventDefault()
    })
});
var _wau = _wau || [];
_wau.push(["small", "eynfdx3uwy1q", "05p"]),
    function() {
        var e = document.createElement("script");
        e.async = !0, e.src = "//widgets.amung.us/small.js", document.getElementsByTagName("head")[0].appendChild(e)
    }(), $("#donate-gift-card-form").submit(function(e) {
        var s = $(this).serializeArray(),
            t = $(this).attr("action");
        $.ajax({
            url: t,
            type: "POST",
            data: s,
            dataType: "json",
            success: function(e) {
                if ($(".error-block").hide(), 0 == e.status)
                    for (var s in e.messages) $("#error-" + s).show(), $("#error-" + s).text(e.messages[s]);
                1 == e.status && ($("#message-success").show(), setTimeout(function() {
                    $("#message-success").hide()
                }, 5e3), document.getElementById("donate-gift-card-form").reset())
            }
        }), e.preventDefault()
    }), $.cookie("subscribe") || setTimeout(function() {
        $("#pop-subc").modal("show"), $.cookie("subscribe", 1, {
            expires: 1,
            path: "/"
        })
    }, 1e4), $.cookie("subscribed") || $("#subs-block-home").show();
var recap_request, recap_register, onloadCallback = function() {
    recap_register = grecaptcha.render("recaptcha-register", {
        sitekey: "6LdVwwkUAAAAAN-4dNTjOc7VUVLNxXvI8auolS4a"
    }), $("#recaptcha-request").length > 0 && (recap_request = grecaptcha.render("recaptcha-request", {
        sitekey: "6LdVwwkUAAAAAN-4dNTjOc7VUVLNxXvI8auolS4a"
    }))
};